<!DOCTYPE HTML>
<html>
	<head>
		<title>Fanhao Jia</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../assets/css/main.css" />
		<noscript><link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>
	</head>
	
<body class="is-preload">
    <nav >
        <div class="container">
            <!-- Navbar links -->
            <div class="navbar-collapse" id="navbar">
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../index.html"><b>主页Home</b></a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
	
<main id="main">
    <div class="content">
				<header class="page-header">
					<center><h2 class="page-title">&nbsp; Chemshell mpiifort编译</h2></center>
				</header>

<section class="wrapper style1 align-left">
	<div class="inner">
	
<div class="language-plaintext highlighter-rouge">
<div class="highlight">
<h2><b>cmake</b></h2>
<pre class="highlight"><code>
不建议使用源码cmake-3.15.5.tar.gz安装。
直接使用二进制比较简单，下载https://github.com/Kitware/CMake/releases/download/v3.15.5/cmake-3.15.5-Linux-x86_64.sh
chmod +x cmake-3.16.0-Linux-x86_64.sh
./cmake-3.16.0-Linux-x86_64.sh
cd cmake-3.16.0-Linux-x86_64/bin
vi ~/.bashrc
export PATH="/share/home/jiafanhao/software/cmake-3.16.0-Linux-x86_64/bin:$PATH"
source ~/.bashrc
</code></pre>
</div>

<div class="language-plaintext highlighter-rouge">
<div class="highlight">
<h2><b>Anaconda3</b></h2>
<pre class="highlight"><code>
下载Anaconda3-4.4.0-Linux-x86_64.sh
chmod +x Anaconda3-4.4.0-Linux-x86_64.sh
./Anaconda3-4.4.0-Linux-x86_64.sh
安装default一路安装
source ~/.bashrc
</code></pre>
</div>

<div class="language-plaintext highlighter-rouge">
<div class="highlight">
<h2><b>Nwchem-6.8.1</b></h2>
<pre class="highlight"><code>
下载nwchem-6.8.1-release.tar.gz
tar -zxvf nwchem-6.8.1-release.tar.gz
cd nwchem-6.8.1-release/src
vi setenv.sh
粘贴下面代码，根据你的系统环境变量调整"
#!/bin/bash -l
module load gold/compiler/intel/ps2018
export MKLROOT=/share/opt/intel/ps2019/compilers_and_libraries_2019.1.144/linux/mkl
export NWCHEM_TOP=/share/apps/nwchem/nwchem-6.8.1-release
export NWCHEM_TARGET=LINUX64
export IB_LIB=/usr/lib64
export IB_INCLUDE=/usr/include
export IB_LIB_NAME="-libverbs"
export ARMCI_NETWORK=OPENIB
export USE_MPI=y
export USE_MPIF=y
export USE_MPIF4=y
export USE_SCALAPACK=y
export MKL_INCLUDE="$MKLROOT/include"
export SCALAPACK="-L$MKLROOT/lib/intel64 -lmkl_scalapack_ilp64 -lmkl_intel_ilp64 -lmkl_blacs_intelmpi_ilp64 -lmkl_core -lmkl_sequential -lpthread -lm"
export SCALAPACK_LIB="$SCALAPACK"
export SCALAPACK_SIZE=8
export BLASOPT="-L$MKLROOT/lib/intel64 -lmkl_intel_ilp64 -lmkl_core -lmkl_sequential -lpthread -lm"
export BLAS_SIZE=8
export USE_NOIO=y
export CRAYPE_LINK_TYPE=dynamic
export LARGE_FILES=true
export NWCHEM_MODULES=all
export FC=ifort
export CC=icc
export CXX=icpc
"
chmod +x setenv.sh
source setenv.sh

make nwchem_config
make
</code></pre>
</div>

<div class="language-plaintext highlighter-rouge">
<div class="highlight">
<h2><b>安装chemshell</b></h2>
<pre class="highlight"><code>
module load gold/compiler/intel/ps2018
下载chemshell, 需要注册邮箱
tar -zxvf chemsh-py-19.0.4.tar.gz
cd chemsh-py-19.0.4
vi setup
将“
    command += ' -DBLAS_DIR:PATH='+args.blas
    command += ' -DLAPACK_DIR:PATH='+args.lapack
    command += ' -DFFTW_DIR:PATH='+args.fftw
    command += ' -DFFTW_INCLUDE_PATH:PATH='+args.fftw_include

    # ScaLAPACK
    if args.scalapack:
        try:
            command += ' -DScaLAPACK_DIR:PATH='+args.scalapack
        except:
            command += ' -DScaLAPACK_DIR:PATH='+args.mkl
    if args.scalapack_flags:
        command += ' -DScaLAPACK_FLAGS:STRING='+'"'+args.scalapack_flags+'"'

    command += ' -DMKL='+args.mkl
    command += ' -DMKL_FLAGS:STRING='+'"'+args.mkl_flags+'"'
”修改为“
    command += ' -DBLAS_DIR:PATH='+'/share/apps/intel/ps2018/compilers_and_libraries_2018.0.128/linux/mkl/lib/intel64'
    command += ' -DLAPACK_DIR:PATH='+'/share/apps/intel/ps2018/compilers_and_libraries_2018.0.128/linux/mkl/lib/intel64'
    command += ' -DFFTW_DIR:PATH='+args.fftw
    command += ' -DFFTW_INCLUDE_PATH:PATH='+'/share/apps/intel/ps2018/compilers_and_libraries_2018.0.128/linux/mkl/include/fftw'

    # ScaLAPACK
    if args.scalapack:
        try:
            command += ' -DScaLAPACK_DIR:PATH='+'/share/apps/intel/ps2018/compilers_and_libraries_2018.0.128/linux/mkl/lib/intel64'
        except:
            command += ' -DScaLAPACK_DIR:PATH='+'/share/apps/intel/ps2018/compilers_and_libraries_2018.0.128/linux/mkl/lib/intel64'
    if args.scalapack_flags:
        command += ' -DScaLAPACK_FLAGS:STRING='+'"'+args.scalapack_flags+'"'

    command += ' -DMKL='+'/share/apps/intel/ps2018/compilers_and_libraries_2018.0.128/linux/mkl/lib/intel64'
    command += ' -DMKL_FLAGS:STRING='+'"'+args.mkl_flags+'"'
”
vi ./chemsh/utils/platforms/ubuntu.py
将“
    elif args.__CHEMSH_ARCH == 'intel':

        args.mkl = args.blas = args.lapack = '/opt/intel/mkl/lib/intel64'
”修改为“
    elif args.__CHEMSH_ARCH == 'intel':

        args.mkl = args.blas = args.lapack = '/share/apps/intel/ps2018/compilers_and_libraries_2018.0.128/linux/mkl/lib/intel64'
”
然后
./setup --mpi --fc mpiifort --cc mpiicc --cpc mpiicpc --nwchem /share/apps/nwchem/nwchem-6.8.1-release

</code></pre>
</div>

</div></section>
</div>
</main>
			<script src="../assets/js/jquery-3.3.1.slim.min.js"></script>
			<script src="../assets/js/popper.min.js"></script>
			<script src="../assets/js/bootstrap.min.js"></script>
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/jquery.scrollex.min.js"></script>
			<script src="../assets/js/jquery.scrolly.min.js"></script>
			<script src="../assets/js/browser.min.js"></script>
			<script src="../assets/js/breakpoints.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<script src="../assets/js/main.js"></script>

	</body>
</html>

