<!DOCTYPE HTML>
<html>
	<head>
		<title>Fanhao Jia</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../assets/css/main.css" />
        <link rel="stylesheet" href="../assets/css/bootstrap.min.css" />
		<link rel="stylesheet" href="../assets/css/katex.min.css" />
		<script src="../assets/js/katex.min.js"></script>
		<script src="../assets/js/auto-render.js"></script>	
		<script type="text/x-mathjax-config">  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<!--<script id="MathJax-script" async src="../assets/js/tex-mml-chtml.js"></script>-->
		<noscript><link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>
    </head>
  
<body>
    <nav >
        <div class="container"> 
            <div class="navbar-collapse" id="navbar">
                <ul class="nav navbar-nav">
                    <li >
                        <a href="https://fanhaojia.github.io/#note"><b>主页Home</b></a>
                    </li>
                </ul>
            </div>
        </div>			
    </nav>
	
<main id="main">
    <div class="content inner">
				<header class="page-header">
					<center><h2 class="page-title">&nbsp; Quantum Espresso编译</h2></center>
				</header>
				
<section class="wrapper style1 align-left">
<div class="inner">

<div class="language-plaintext highlighter-rouge">
<div class="highlight">
<h2><b>环境变量</b></h2>
<pre class="highlight"><code>
source /THFS/opt/intel/composer_xe_2013_sp1.3.174/bin/compilervars.sh intel64
source /THFS/opt/intel/composer_xe_2013_sp1.3.174/mkl/bin/mklvars.sh intel64
source /THFS/opt/intel/impi/5.0.2.044/intel64/bin/mpivars.sh intel64

or
source /THFS/opt/intel/parallel_studio_xe_2018_update2/compilers_and_libraries_2018.2.199/linux/bin/compilervars.sh intel64
source /THFS/opt/intel/parallel_studio_xe_2018_update2/compilers_and_libraries_2018.2.199/linux/mkl/bin/mklvars.sh intel64
</code></pre>
</div></div>


<div class="language-plaintext highlighter-rouge">
<div class="highlight">
<h2><b>Libxc编译</b></h2>
<pre class="highlight"><code>
./configure CC=icc CXX=icpc FC=ifort --prefix=/THFS/home/gk_ahu_ljy/softwares/libxc-4.3.4
make 
make install
</code></pre>
</div></div>

<div class="language-plaintext highlighter-rouge">
<div class="highlight">
<h2><b>Install QE</b></h2>
<pre class="highlight"><code>
export MKLROOT=/THFS/opt/intel/composer_xe_2013_sp1.3.174/mkl
./configure --prefix=/THFS/home/gk_ahu_ljy/softwares/qe-6.4.1/2013 F90=ifort MPIF90=mpiifort MPIF77=mpiifort MPICC=mpiicc F77=ifort FC=ifort BLAS_LIBS="-Wl,--start-group $MKLROOT/lib/intel64/libmkl_intel_lp64.a $MKLROOT/lib/intel64/libmkl_sequential.a $MKLROOT/lib/intel64/libmkl_core.a -Wl,--end-group" SCALAPACK_LIBS="-Wl,--start-group $MKLROOT/lib/intel64/libmkl_scalapack_lp64.a $MKLROOT/lib/intel64/libmkl_blacs_intelmpi_lp64.a -Wl,--end-group"

./configure --prefix=/THFS/home/gk_ahu_ljy/softwares/qe-6.4.1 FC=ifort CC=icc MPIF90=mpiifort --with-libxc="yes" --with-libxc-prefix="/THFS/home/gk_ahu_ljy/softwares/libxc-4.3.4" --with-libxc-include="/THFS/home/gk_ahu_ljy/softwares/libxc-4.3.4/include" --enable-parallel --with-scalapack="intel" BLAS_LIBS="-L$MKLROOT/lib/intel64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core" SCALAPACK_LIBS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_blacs_intelmpi_lp64" 

./configure --prefix=/THFS/home/gk_ahu_ljy/softwares/qe-6.4.1_mpif90 FC=ifort CC=icc MPIF90=mpif90 --with-libxc="yes" --with-libxc-prefix="/THFS/home/gk_ahu_ljy/softwares/libxc-4.3.4" --with-libxc-include="/THFS/home/gk_ahu_ljy/softwares/libxc-4.3.4/include" --enable-parallel --with-scalapack="intel" BLAS_LIBS="$MKLROOT/lib/intel64/libmkl_blas95_lp64.a" LAPACK="$MKLROOT/lib/intel64/libmkl_lapack95_lp64.a" SCALAPACK_LIBS="$MKLROOT/lib/intel64/libmkl_scalapack_lp64.a -lmkl_blacs_intelmpi_lp64" 

make all

or
export MKLROOT=/THFS/opt/intel/parallel_studio_xe_2018_update2/compilers_and_libraries_2018.2.199/linux/mkl
./configure --prefix=/THFS/home/gk_ahu_ljy/softwares/qe-6.4.1/2018 FC=ifort CC=icc MPIF90=mpiifort --with-libxc="yes" --with-libxc-prefix="/THFS/home/gk_ahu_ljy/softwares/libxc-4.3.4" --with-libxc-include="/THFS/home/gk_ahu_ljy/softwares/libxc-4.3.4/include" 
--enable-parallel --with-scalapack="intel" BLAS_LIBS="-L$MKLROOT/lib/intel64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core" SCALAPACK_LIBS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_lp64 -lmkl_blacs_intelmpi_lp64"
make all

./configure --prefix=/THFS/home/gk_ahu_ljy/softwares/qe-6.4.1/2018 FC=ifort CC=icc MPIF90=mpiifort --enable-parallel --with-scalapack="intel" BLAS_LIBS="-L$MKLROOT/lib/intel64 -lmkl_intel_ilp64 -lmkl_sequential -lmkl_core" SCALAPACK_LIBS="-L$MKLROOT/lib/intel64 -lmkl_scalapack_ilp64 -lmkl_blacs_intelmpi_ilp64" FFT_LIBS=/THFS/opt/intel/parallel_studio_xe_2018_update2/compilers_and_libraries_2018.2.199/linux/mkl/interfaces/fftw3xf/libfftw3xf_intel.a

赝势下载：<a href="https://www.quantum-espresso.org/pseudopotentials">https://www.quantum-espresso.org/pseudopotentials</a>
参数注释：<a href="https://www.quantum-espresso.org/Doc/INPUT_PW.html">https://www.quantum-espresso.org/Doc/INPUT_PW.html</a>
计算例子：<a href="https://gitlab.com/QEF/q-e/tree/master/PW/examples">https://gitlab.com/QEF/q-e/tree/master/PW/examples</a>


./configure --prefix=/THFS/home/gk_ahu_ljy/softwares/qe-6.4.1/2013 
MPIF90=mpif90 F90=ifort F77=ifort CC=icc BLAS_LIBS="-lmkl_intel_lp64 -lmkl_sequential -lmkl_core" 
LAPACK_LIBS=/THFS/opt/intel/composer_xe_2013.0.079/mkl/lib/intel64/libmkl_lapack95_lp64.a
SCALAPACK_LIBS=/THFS/opt/intel/composer_xe_2013.0.079/mkl/lib/intel64/libmkl_scalapack_lp64.a
FFT_LIBS=/THFS/opt/intel/composer_xe_2013.0.079/mkl/interfaces/fftw3xf/libfftw3xf_intel.a


./configure --prefix=/THFS/home/gk_ahu_ljy/softwares/qe-6.4.1/2013 
MPIF90=mpif90 F90=gfortran F77=gfortran CC=cc 
BLAS_LIBS="-lmkl_gf_lp64  -lmkl_sequential -lmkl_core"
SCALAPACK_LIBS="-lmkl_scalapack_lp64 -lmkl_blacs_openmpi_lp64"


</code></pre>
</div></div>

</div>

</div></section>
</div>
</main>
			<script src="../assets/js/jquery-3.3.1.slim.min.js"></script>
			<script src="../assets/js/popper.min.js"></script>
			<script src="../assets/js/bootstrap.min.js"></script>
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/jquery.scrollex.min.js"></script>
			<script src="../assets/js/jquery.scrolly.min.js"></script>
			<script src="../assets/js/browser.min.js"></script>
			<script src="../assets/js/breakpoints.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<script src="../assets/js/main.js"></script>

	</body>
</html>

